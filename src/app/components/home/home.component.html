<div *ngIf="userRole=='MANAGER'">
    <button pButton pRipple type="button" label="Create Project" (click)="showCreateProjectModal()"></button>
    <div>
        <h5>Managed Projects:</h5>

        <p-table [value]="managedProjects">
            <ng-template pTemplate="header">
                <tr>
                    <th>Project Id</th>
                    <th>Project Name</th>
                    <th>Project Type</th>
                    <th>Manage Users</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-proj>
                <tr>
                    <td>{{proj.projectId}}</td>
                    <td>{{proj.projectName}}</td>
                    <td>{{proj.projectType}}</td>
                    <td>
                        <button pButton pRipple type="button" label="Manage Users"
                            (click)="showUsersPopup(proj.projectId)"></button>
                    </td>
                </tr>
            </ng-template>
        </p-table>

    </div>
    <p-dialog header="Manage Users" [(visible)]="showUsersPopupCheck" [style]="{height: '95vh'}" [modal]="true">
        <p-table [value]="usersList">
            <ng-template pTemplate="header">
                <tr>
                    <th>Email</th>
                    <th>First Name</th>
                    <th>Last Name</th>
                    <th>Role</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-proj>
                <tr>
                    <td>{{proj.emailId}}</td>
                    <td>{{proj.firstName}}</td>
                    <td>{{proj.lastName}}</td>
                    <td>
                        {{proj.mainRole[0].collaborationRole}}
                    </td>
                </tr>
            </ng-template>
        </p-table>
        <p-dropdown [options]="allUsers" [(ngModel)]="processedUser" placeholder="Select user" optionLabel="emailId"
            (onChange)="checkUserAlreadyPresent()"></p-dropdown>
        <p-dropdown *ngIf="processedUser !== undefined" [options]="userCollabRole"
            [(ngModel)]="selectedRole" (onChange)="checkUserAlreadyPresent()"></p-dropdown>
        <!-- <p-message *ngIf="userPresentError" severity="warn" text="User already present"></p-message> -->
        <button *ngIf="userPresentError && processedUser !== undefined" pButton pRipple type="button"
            icon="pi pi-pencil" (click)="modifyUser()"></button>
        <button *ngIf="!userPresentError && processedUser !== undefined" pButton pRipple type="button"
            icon="pi pi-check" (click)="addUserToList()"></button>
        <ng-template pTemplate="footer">
            <p-button icon="pi pi-check" (click)="manageUsersForProjects()" label="Ok" styleClass="p-button-text">
            </p-button>
        </ng-template>
    </p-dialog>

    <p-dialog header="Create Project" [(visible)]="showCreateProjectPopup" [style]="{height: '95vh'}" [modal]="true">
        <div class="field pad">
            <input id="pname" type="text" pInputText [(ngModel)]="newProjectDetails.projectName"
                placeholder="Project Name">
        </div>
        <div class="field pad">
            <p-dropdown id="ptypeSelect" [options]="projectTypes" [(ngModel)]="newProjectDetails.projectType"></p-dropdown>
        </div>
        <div class="field pad">
            <p-button icon="pi pi-plus" (click)="createProject()" label="Create Project" styleClass="p-button-text">
            </p-button>
        </div>
        <div class="field pad" *ngIf="managerUserAfterCreateProject">
            <p-button icon="pi pi-chevron-circle-right" (click)="showUsersPopup(currentProjectId)" label="Manage Users" styleClass="p-button-text">
            </p-button>
        </div>
    </p-dialog>
</div>